{"version":3,"sources":["webpack:///./src/views/Admin.vue","webpack:///src/views/Admin.vue","webpack:///./src/views/Admin.vue?ca30","webpack:///./src/views/Admin.vue?4b09","webpack:///./src/views/Admin.vue?08c4"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","_m","_v","on","$event","preventDefault","stopPropagation","handleSubmit","apply","arguments","attrs","directives","name","rawName","value","account","expression","class","redBottomLine","errorMsg","domProps","target","composing","_e","password","isProcessing","_s","staticRenderFns","data","methods","Toast","icon","title","localStorage","console","component"],"mappings":"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","file":"js/chunk-2d292f4a.f013625f.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mx-auto\",staticStyle:{\"width\":\"400px\"}},[_vm._m(0),_c('h3',{staticClass:\"title text-center font-weight-bold mt-4\"},[_vm._v(\"後台登入\")]),_c('form',{on:{\"submit\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleSubmit.apply(null, arguments)}}},[_c('div',{staticClass:\"form-wrapper\"},[_c('label',{attrs:{\"for\":\"account\"}},[_vm._v(\"帳號\")]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.account),expression:\"account\"}],staticClass:\"form\",class:{ redBottomLine: _vm.errorMsg === '此帳號不存在！' },attrs:{\"id\":\"account\",\"name\":\"account\",\"type\":\"text\",\"placeholder\":\"請輸入帳號\",\"required\":\"\",\"autofocus\":\"\"},domProps:{\"value\":(_vm.account)},on:{\"input\":function($event){if($event.target.composing)return;_vm.account=$event.target.value}}}),_c('div',{staticClass:\"error-alert\"},[(_vm.errorMsg === '此帳號不存在!')?_c('span',[_vm._v(\"帳號不存在\")]):_vm._e()])])]),_c('div',{staticClass:\"form-wrapper\"},[_c('label',{attrs:{\"for\":\"password\"}},[_vm._v(\"密碼\")]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.password),expression:\"password\"}],staticClass:\"form\",class:{ redBottomLine: _vm.errorMsg === '密碼錯誤！' },attrs:{\"id\":\"password\",\"name\":\"password\",\"type\":\"password\",\"placeholder\":\"請輸入密碼\",\"autocomplete\":\"current-password\",\"required\":\"\"},domProps:{\"value\":(_vm.password)},on:{\"input\":function($event){if($event.target.composing)return;_vm.password=$event.target.value}}}),_c('div',{staticClass:\"error-alert\"},[(_vm.errorMsg === '密碼錯誤！')?_c('span',[_vm._v(\"密碼錯誤\")]):_vm._e()])])]),_c('div',{staticClass:\"mt-4\"},[_c('button',{staticClass:\"btn btn-info btn-singin\",attrs:{\"type\":\"submit\",\"disabled\":_vm.isProcessing}},[_vm._v(\" \"+_vm._s(_vm.isProcessing ? \"驗證中\" : \"登入\")+\" \")])])]),_c('div',{staticClass:\"d-flex mt-4 justify-content-end\"},[_c('router-link',{staticClass:\"mx-1\",attrs:{\"to\":\"/login\"}},[_vm._v(\" 前台登入 \")])],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mx-auto\",staticStyle:{\"width\":\"40px\"}},[_c('img',{staticClass:\"mx-auto mt-5\",attrs:{\"width\":\"40px\",\"src\":\"https://i.postimg.cc/Dfp23k8g/logo-2x.png\",\"alt\":\"LogoImage\"}})])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"mx-auto\" style=\"width: 400px\">\n    <div class=\"mx-auto\" style=\"width: 40px\">\n      <img\n        class=\"mx-auto mt-5\"\n        width=\"40px\"\n        src=\"https://i.postimg.cc/Dfp23k8g/logo-2x.png\"\n        alt=\"LogoImage\"\n      />\n    </div>\n    <h3 class=\"title text-center font-weight-bold mt-4\">後台登入</h3>\n\n    <form @submit.prevent.stop=\"handleSubmit\">\n      <div class=\"form-wrapper\">\n        <label for=\"account\">帳號</label>\n        <div>\n          <input\n            id=\"account\"\n            v-model=\"account\"\n            name=\"account\"\n            type=\"text\"\n            class=\"form\"\n            :class=\"{ redBottomLine: errorMsg === '此帳號不存在！' }\"\n            placeholder=\"請輸入帳號\"\n            required\n            autofocus\n          />\n          <div class=\"error-alert\">\n            <span v-if=\"errorMsg === '此帳號不存在!'\">帳號不存在</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"form-wrapper\">\n        <label for=\"password\">密碼</label>\n        <div>\n          <input\n            id=\"password\"\n            v-model=\"password\"\n            name=\"password\"\n            type=\"password\"\n            class=\"form\"\n            :class=\"{ redBottomLine: errorMsg === '密碼錯誤！' }\"\n            placeholder=\"請輸入密碼\"\n            autocomplete=\"current-password\"\n            required\n          />\n          <div class=\"error-alert\">\n            <span v-if=\"errorMsg === '密碼錯誤！'\">密碼錯誤</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"mt-4\">\n        <button\n          type=\"submit\"\n          class=\"btn btn-info btn-singin\"\n          :disabled=\"isProcessing\"\n        >\n          {{ isProcessing ? \"驗證中\" : \"登入\" }}\n        </button>\n      </div>\n    </form>\n    <div class=\"d-flex mt-4 justify-content-end\">\n      <router-link class=\"mx-1\" to=\"/login\"> 前台登入 </router-link>\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport { Toast } from \"./../utils/helpers\";\nimport authorizationAPI from \"./../apis/authorization\";\n\nexport default {\n  name: \"Admin\",\n  data() {\n    return {\n      account: \"\",\n      password: \"\",\n      isProcessing: false,\n      errorMsg: \"\",\n    };\n  },\n  methods: {\n    async handleSubmit() {\n      try {\n        // 重新設定錯誤訊息\n        this.errorMsg = \"\";\n\n        // 表單驗證失敗：攔截惡意拿掉帳密 required 屬性而送出表單的狀況\n        if (!this.account || !this.password) {\n          // STEP1. 如果 email 或 password 為空，則使用 Toast 提示\n          Toast.fire({\n            icon: \"warning\",\n            title: \"帳號和密碼為必填\",\n          });\n          // STEP2. 然後 return 不繼續往後執行\n          return;\n        }\n\n        // 表單驗證成功：帳密皆有填寫\n        // STEP1. 讓登入按鈕失效\n        this.isProcessing = true;\n\n        // STEP2. 將帳密透過 API 送回伺服器驗證，並取得回傳的資料\n        const res = await authorizationAPI.adminSignIn({\n          account: this.account,\n          password: this.password,\n        });\n        const { data } = res;\n\n        // STEP3-1. 帳密驗證若失敗，API 回傳錯誤\n        if (data.status === \"error\") {\n          throw new Error(data.message);\n        }\n\n        // STEP3-2. 帳密驗證若成功\n        // 將 token 存在 localStorage 裡\n        localStorage.setItem(\"token\", data.data.token);\n\n        // 把 API 回傳的目前使用者資料存進 Vuex 裡\n        this.$store.commit(\"setCurrentUser\", data.data.user);\n\n        // 登入成功, 直接轉址到首頁 （不需還原 isProcessing 的狀態）\n        this.$router.push(\"/admin/tweets\");\n\n        // 登入失敗\n      } catch (error) {\n        // 帳號或密碼輸入錯誤後，將密碼欄位清空\n        this.password = \"\";\n\n        // 因為登入失敗，所以要把按鈕狀態還原\n        this.isProcessing = false;\n\n        // 錯誤通知處理\n        console.error(error.message);\n        this.errorMsg = error.message;\n\n        if (error.message === \"此帳號不存在！\") {\n          Toast.fire({\n            icon: \"error\",\n            title: \"帳號不存在，請重新確認\",\n          });\n        } else if (error.message === \"密碼錯誤！\") {\n          Toast.fire({\n            icon: \"error\",\n            title: \"密碼錯誤，請重新輸入\",\n          });\n        } else {\n          Toast.fire({\n            icon: \"error\",\n            title: \"目前無法登入，請稍後再試\",\n          });\n        }\n      }\n    },\n  },\n};\n</script>\n\n\n<style lang=\"scss\">\n@import \"../assets/scss/login.scss\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Admin.vue?vue&type=template&id=b29abac0&\"\nimport script from \"./Admin.vue?vue&type=script&lang=js&\"\nexport * from \"./Admin.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Admin.vue?vue&type=style&index=0&id=b29abac0&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=style&index=0&id=b29abac0&prod&lang=scss&\""],"sourceRoot":""}